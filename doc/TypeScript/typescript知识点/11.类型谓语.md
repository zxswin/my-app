## 类型谓语

- 一个简单的自定义类型保护的类型谓词

```ts
function isNumber(x: any): x is number {
  return typeof x === 'number';
}

function isString(x: any): x is string {
  return typeof x === 'string';
}
```

- 一个类型谓语的使用例子

```ts
interface Vehicle {
  move: (distance: number) => void;
}

class Car implements Vehicle {
  move = (distance: number) => {
    // Move car…
  };

  turnSteeringWheel = (direction: string) => {
    // Turn wheel…
  };
}

class VehicleController {
  vehicle: Vehicle;
  constructor(vehicle: Vehicle) {
    this.vehicle = vehicle;
  }
}

const car = new Car();
const vehicleController = new VehicleController(car);

const { vehicle } = vehicleController;
vehicle.turnSteeringWheel('left'); // 会报错因为找不到turnSteeringWheel

// 自定义类型保护
function isCar(vehicle: any): vehicle is Car {
  return (vehicle as Car).turnSteeringWheel !== undefined;
}

if (isCar(vehicle)) {
  vehicle.turnSteeringWheel('left');
  console.log('这是一辆车');
} else {
  console.log('这不是一辆车');
}
```

- 自定义类型保护来保护基本类型的类型安全

```ts
const isNumber = (variableToCheck: any): variableToCheck is number => (variableToCheck as number).toExponential !== undefined;

const isString = (variableToCheck: any): variableToCheck is string => (variableToCheck as string).toLowerCase !== undefined;

// 可以通过泛型来解决复用的问题
function isOfType<T>(varToBeChecked: any, propertyToCheckFor: keyof T): varToBeChecked is T {
  return (varToBeChecked as T)[propertyToCheckFor] !== undefined;
}

// 结合上一个例子则可以这么用
if (isOfType<Car>(vehicle, 'turnSteeringWheel')) {
  anotherCar.turnSteeringWheel('left');
  console.log('这是一辆车');
} else {
  console.log('这不是一辆车');
}
```

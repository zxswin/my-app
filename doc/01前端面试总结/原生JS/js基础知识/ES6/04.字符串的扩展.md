## 字符的 Unicode 表示法

```js
// 允许采用\uxxxx形式表示一个字符，其中xxxx表示字符的 Unicode 码点。
'\u0061';
// "a"

// 这种表示法只限于码点在\u0000~\uFFFF之间的字符。超出这个范围的字符，必须用两个双字节的形式表示。
'\uD842\uDFB7';
// "𠮷"

// 如果直接在\u后面跟上超过0xFFFF的数值（比如\u20BB7），JavaScript 会理解成\u20BB+7。由于\u20BB是一个不可打印字符，所以只会显示一个空格，后面跟着一个7。
'\u20BB7';
// " 7"
```

```js
// ES6 对这一点做出了改进，只要将码点放入大括号，就能正确解读该字符。
// 大括号表示法与四字节的 UTF-16 编码是等价的
'\u{20BB7}';
// "𠮷"

'\u{41}\u{42}\u{43}';
// "ABC"

let hello = 123;
hello; // 123

'\u{1F680}' === '\uD83D\uDE80';
// true
```

```js
// JavaScript 共有 6 种方法可以表示一个字符。
// '\z' === 'z'  // true
// '\172' === 'z' // true
// '\x7A' === 'z' // true
// '\u007A' === 'z' // true
// '\u{7A}' === 'z' // true
```

## 字符串的遍历器接口

```js
// 字符串可以被for...of循环遍历。
for (let codePoint of 'foo') {
  console.log(codePoint);
}
// "f"
// "o"
// "o"
```

```js
// 这个遍历器最大的优点是可以识别大于0xFFFF的码点，传统的for循环无法识别这样的码点。
let text = String.fromCodePoint(0x20bb7);

for (let i = 0; i < text.length; i++) {
  console.log(text[i]);
}
// " "
// " "

for (let i of text) {
  console.log(i);
}
// "𠮷"
```

## 直接输入 U+2028 和 U+2029

```js
'中' === '\u4e2d'; // true

// JavaScript 规定有5个字符，不能在字符串里面直接使用，只能使用转义形式。

// U+005C：反斜杠（reverse solidus)
// U+000D：回车（carriage return）
// U+2028：行分隔符（line separator）
// U+2029：段分隔符（paragraph separator）
// U+000A：换行符（line feed）

// 字符串里面不能直接包含反斜杠，一定要转义写成\\或者\u005c。

// JSON 格式允许字符串里面直接使用 U+2028（行分隔符）和 U+2029（段分隔符）
// 样一来，服务器输出的 JSON 被JSON.parse解析，就有可能直接报错。
// ES2019 允许 JavaScript 字符串直接输入 U+2028（行分隔符）和 U+2029（段分隔符）。
const PS = eval("'\u2029'");
```

## JSON.stringify() 的改造

```js
// 为了确保返回的是合法的 UTF-8 字符，ES2019 改变了JSON.stringify()的行为。如果遇到0xD800到0xDFFF之间的单个码点，或者不存在的配对形式，它会返回转义字符串，留给应用自己决定下一步的处理。

JSON.stringify('\u{D834}'); // ""\\uD834""
JSON.stringify('\uDF06\uD834'); // ""\\udf06\\ud834""
```

## 模板字符串

```js
$('#result').append(`
  There are <b>${basket.count}</b> items
   in your basket, <em>${basket.onSale}</em>
  are on sale!
`);
```

```js
// 模板字符串，都是用反引号表示
// 普通字符串
`In JavaScript '\n' is a line-feed.` // 多行字符串
`In JavaScript this is
 not legal.`;

console.log(`string text line 1
string text line 2`);

// 字符串中嵌入变量
let name = 'Bob',
  time = 'today';
`Hello ${name}, how are you ${time}?`;
```

```js
// 如果在模板字符串中需要使用反引号，则前面要用反斜杠转义。
let greeting = `\`Yo\` World!`;
```

```js
// 模板字符串之中还能调用函数。
function fn() {
  return 'Hello World';
}

`foo ${fn()} bar`;
// foo Hello World bar
```

```js
// 如果大括号内部是一个字符串，将会原样输出。
`Hello ${'World'}`;
// "Hello World"
```

## 标签模板

```js
// 它可以紧跟在一个函数名后面，该函数将被调用来处理这个模板字符串。这被称为“标签模板”功能（tagged template）。
alert`hello`;
// 等同于
alert(['hello']);
```

```js
let a = 5;
let b = 10;

tag`Hello ${a + b} world ${a * b}`;
// 等同于
tag(['Hello ', ' world ', ''], 15, 50);
```

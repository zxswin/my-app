## 关于 Mirage

```js
// Mirage JS 是一个 API 模拟库，它可以帮你构建、 测试并演示完整可运行的 JavaScript 应用程序， 而不必依赖任何后端服务。

// 与其他模拟库不同，Mirage 使重建动态 场景变得容易，动态场景通常仅在实际 生产环境中才可能出现。
```

- 原理

```js
// Mirage 在浏览器中运行。它拦截您的 JavaScript 应用程序发出的任何 XMLHttpRequest 或 fetch 发出的请求，并允许您模拟这些请求所对应的响应结果。这意味着您可以像在与真实服务器对话一样开发和测试您的应用程序。

// 除了拦截 HTTP 请求外，Mirage 还提供了一个模拟数据库和一系列辅助函数，可以轻松地模拟动态的后端服务。
```

- 快速配置模拟服务器。

```js
// Mirage 借鉴了典型服务器端框架的概念，例如：

// 处理 HTTP 请求的 路由（routes）
// 数据库（database） 和 数据模型（models） 用于存储数据和定义数据之间的关系
// 用于 stubbing data 的 工厂函数（factories） 和 fixtures
// 用于格式化 HTTP 响应的 序列化程序（serializers）
// 帮助您快速配置模拟服务器。
```

## 安装

```bash
# 使用 npm 安装
npm install --save-dev miragejs

# 使用 Yarn 安装
yarn add --dev miragejs
```

## 使用

```js
import { createServer, Response } from 'miragejs';

createServer({
  routes() {
    this.namespace = 'api';

    // Responding to a POST request
    this.post('/movies', (schema, request) => {
      let attrs = JSON.parse(request.requestBody);
      attrs.id = Math.floor(Math.random() * 100);

      return { movie: attrs };
    });

    // Using the `timing` option to slow down the response
    this.get(
      '/movies',
      () => {
        return {
          movies: [
            { id: 1, name: 'Inception', year: 2010 },
            { id: 2, name: 'Interstellar', year: 2014 },
            { id: 3, name: 'Dunkirk', year: 2017 },
          ],
        };
      },
      { timing: 4000 }
    );

    // Using the `Response` class to return a 500
    this.delete('/movies/1', () => {
      let headers = {};
      let data = { errors: ['Server did not respond'] };

      return new Response(500, headers, data);
    });
  },
});
```

## 参考文档

```js
// 官方文档
// https://www.miragejs.cn/
```

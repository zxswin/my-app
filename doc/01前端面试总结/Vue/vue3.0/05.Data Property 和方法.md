## Data Property

```js
// 组件的 data 选项是一个函数。Vue 会在创建新组件实例的过程中调用此函数。它应该返回一个对象，然后 Vue 会通过响应性系统将其包裹起来，并以 $data 的形式存储在组件实例中。

const app = Vue.createApp({
  data() {
    return { count: 4 };
  },
});

const vm = app.mount('#app');

console.log(vm.$data.count); // => 4
console.log(vm.count); // => 4

// 修改 vm.count 的值也会更新 $data.count
vm.count = 5;
console.log(vm.$data.count); // => 5

// 反之亦然
vm.$data.count = 6;
console.log(vm.count); // => 6
```

```js
// 直接将不包含在 data 中的新 property 添加到组件实例是可行的。但由于该 property 不在背后的响应式 $data 对象内，所以 Vue 的响应性系统不会自动跟踪它。

// Vue 使用 $ 前缀通过组件实例暴露自己的内置 API。它还为内部 property 保留 _ 前缀。你应该避免使用这两个字符开头的顶级 data property 名称。
```

## 方法

```js
// 定义 methods 时应避免使用箭头函数，因为这会阻止 Vue 绑定恰当的 this 指向。
// 用 methods 选项向组件实例添加方法，它应该是一个包含所需方法的对象：
const app = Vue.createApp({
  data() {
    return { count: 4 };
  },
  methods: {
    increment() {
      // `this` 指向该组件实例
      this.count++;
    },
  },
});

const vm = app.mount('#app');

console.log(vm.count); // => 4

vm.increment();

console.log(vm.count); // => 5
```

```html
<!-- 
  在组件模版中访问方法
-->

<button @click="increment">Up vote</button>

<!-- 直接从模板中调用方法 -->
<span :title="toTitleDate(date)"> {{ formatDate(date) }} </span>
```

## 防抖和节流

```html
<!-- 如果某个组件仅使用一次，可以在 methods 中直接应用防抖： -->
<script src="https://unpkg.com/lodash@4.17.20/lodash.min.js"></script>
<script>
  Vue.createApp({
    methods: {
      // 用 Lodash 的防抖函数
      click: _.debounce(function () {
        // ... 响应点击 ...
      }, 500),
    },
  }).mount('#app');
</script>
```

```js
// 为了使组件实例彼此独立，可以在生命周期钩子的 created 里添加该防抖函数:
app.component('save-button', {
  created() {
    // 使用 Lodash 实现防抖
    this.debouncedClick = _.debounce(this.click, 500);
  },
  unmounted() {
    // 移除组件时，取消定时器
    this.debouncedClick.cancel();
  },
  methods: {
    click() {
      // ... 响应点击 ...
    },
  },
  template: `
    <button @click="debouncedClick">
      Save
    </button>
  `,
});
```

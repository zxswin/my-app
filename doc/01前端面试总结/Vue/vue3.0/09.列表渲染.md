## 用 v-for 把一个数组映射为一组元素

```html
<ul id="array-rendering">
  <li v-for="item in items">{{ item.message }}</li>
</ul>
```

```js
Vue.createApp({
  data() {
    return {
      items: [{ message: 'Foo' }, { message: 'Bar' }],
    };
  },
}).mount('#array-rendering');
```

- v-for 还支持一个可选的第二个参数，即当前项的索引。

```html
<ul id="array-with-index">
  <li v-for="(item, index) in items">
    {{ parentMessage }} - {{ index }} - {{ item.message }}
  </li>
</ul>
```

```js
Vue.createApp({
  data() {
    return {
      parentMessage: 'Parent',
      items: [{ message: 'Foo' }, { message: 'Bar' }],
    };
  },
}).mount('#array-with-index');
```

- 用 of 替代 in 作为分隔符

```html
<div v-for="item of items"></div>
```

## 在 v-for 里使用对象

- 用 v-for 来遍历一个对象的 property

```html
<ul id="v-for-object" class="demo">
  <li v-for="value in myObject">{{ value }}</li>
</ul>
```

```js
Vue.createApp({
  data() {
    return {
      myObject: {
        title: 'How to do lists in Vue',
        author: 'Jane Doe',
        publishedAt: '2016-04-10',
      },
    };
  },
}).mount('#v-for-object');
```

- 第二个的参数为 property 名称 (也就是键名 key)

```html
<li v-for="(value, name) in myObject">{{ name }}: {{ value }}</li>
```

- 第三个参数作为索引

```html
<!-- 会按 Object.keys() 的结果遍历 -->
<li v-for="(value, name, index) in myObject">
  {{ index }}. {{ name }}: {{ value }}
</li>
```

- 每项提供一个唯一的 key attribute：

```html
<div v-for="item in items" :key="item.id">
  <!-- 内容 -->
</div>
```

## 数组更新检测

```js
// Vue 将被侦听的数组的变更方法进行了包裹，所以它们也将会触发视图更新
// push()
// pop()
// shift()
// unshift()
// splice()
// sort()
// reverse()
```

- 替换数组

```js
// 当使用非变更方法时，可以用新数组替换旧数组
// filter()、concat() 和 slice()
example1.items = example1.items.filter((item) => item.message.match(/Foo/));
```

## 显示过滤/排序后的结果

```html
<!-- 创建一个计算属性，来返回过滤或排序后的数组 -->
<li v-for="n in evenNumbers" :key="n">{{ n }}</li>
```

```js
data() {
  return {
    numbers: [ 1, 2, 3, 4, 5 ]
  }
},
computed: {
  evenNumbers() {
    return this.numbers.filter(number => number % 2 === 0)
  }
}
```

- 在计算属性不适用的情况下 (例如，在嵌套的 v-for 循环中) 你可以使用一个方法：

```html
<ul v-for="numbers in sets">
  <li v-for="n in even(numbers)" :key="n">{{ n }}</li>
</ul>
```

```js
data() {
  return {
    sets: [[ 1, 2, 3, 4, 5 ], [6, 7, 8, 9, 10]]
  }
},
methods: {
  even(numbers) {
    return numbers.filter(number => number % 2 === 0)
  }
}
```

## 在 v-for 里使用值的范围

```html
<!-- 
  v-for 也可以接受整数。在这种情况下，它会把模板重复对应次数。
-->

<div id="range" class="demo">
  <span v-for="n in 10" :key="n">{{ n }} </span>
</div>
```

- 在 <template> 中使用 v-for

```html
ul>
  <template v-for="item in items" :key="item.msg">
    <li>{{ item.msg }}</li>
    <li class="divider" role="presentation"></li>
  </template>
</ul>
```

## v-for 与 v-if 一同使用

```html
<!-- 
  不推荐在同一元素上使用 v-if 和 v-for
  当它们处于同一节点，v-if 的优先级比 v-for 更高，这意味着 v-if 将没有权限访问 v-for 里的变量：
 -->

<!-- 这将抛出一个错误，因为“todo” property 没有在实例上定义 -->

<li v-for="todo in todos" v-if="!todo.isComplete">{{ todo.name }}</li>

<!-- 可以把 v-for 移动到 <template> 标签中来修正： -->
<template v-for="todo in todos" :key="todo.name">
  <li v-if="!todo.isComplete">{{ todo.name }}</li>
</template>
```

## 在组件上使用 v-for

```html
<!-- 在自定义组件上，你可以像在任何普通元素上一样使用 v-for： -->
<my-component v-for="item in items" :key="item.id"></my-component>

<!-- 为了把迭代数据传递到组件里，我们要使用 props： -->
<my-component
  v-for="(item, index) in items"
  :item="item"
  :index="index"
  :key="item.id"
></my-component>
```

## 一个简单的 todo 列表的完整例子

```html
<div id="todo-list-example">
  <form v-on:submit.prevent="addNewTodo">
    <label for="new-todo">Add a todo</label>
    <input
      v-model="newTodoText"
      id="new-todo"
      placeholder="E.g. Feed the cat"
    />
    <button>Add</button>
  </form>
  <ul>
    <todo-item
      v-for="(todo, index) in todos"
      :key="todo.id"
      :title="todo.title"
      @remove="todos.splice(index, 1)"
    ></todo-item>
  </ul>
</div>
```

```js
const app = Vue.createApp({
  data() {
    return {
      newTodoText: '',
      todos: [
        {
          id: 1,
          title: 'Do the dishes',
        },
        {
          id: 2,
          title: 'Take out the trash',
        },
        {
          id: 3,
          title: 'Mow the lawn',
        },
      ],
      nextTodoId: 4,
    };
  },
  methods: {
    addNewTodo() {
      this.todos.push({
        id: this.nextTodoId++,
        title: this.newTodoText,
      });
      this.newTodoText = '';
    },
  },
});

app.component('todo-item', {
  template: `
    <li>
      {{ title }}
      <button @click="$emit('remove')">Remove</button>
    </li>
  `,
  props: ['title'],
  emits: ['remove'],
});

app.mount('#todo-list-example');
```

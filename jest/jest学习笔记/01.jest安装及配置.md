## jest 安装及配置


- jest 依赖的安装
```js
// 使用 ​yarn​ 安装 Jest︰
// yarn add --dev jest

// 或使用 ​npm​ 安装 Jest：
// npm install --save-dev jest
```


## 一个简单的使用jest进行单元测试的例子

- sum.js

```js
function sum(a, b) {
  return a + b;
}
module.exports = sum;
```

- sum.test.js
```java
const sum = require('./sum');
test('adds 1 + 2 to equal 3', () => {
  expect(sum(1, 2)).toBe(3);
});
```

- package.json
```json
{
  "scripts": {
    "test": "jest"
  }
}
```

- 运行jest进行单元测试

```java
// 运行​ yarn test​ 或 ​npm run test
```

- 全局模式下运行jest

```js
// 全局模式下安装相关依赖
// yarn global add jest​ 或 ​npm install jest --global​安装的​Jest​)
// 匹配到 ​my-test​ 的文件运行 ​Jest​、使用​config.json ​作为一个配置文件
```

## jest的配置文件

```js
// 生成一个基础配置文件
// jest --init


// 使用 Babel
// yarn add --dev babel-jest @babel/core @babel/preset-env
```

- babel.config.js 的相关配置

```js
// babel.config.js
module.exports = {
  presets: [
    [
      '@babel/preset-env',
      {
        targets: {
          node: 'current',
        },
      },
    ],
  ],
};
```


- 有条件设置地仅设置jest所需的编译配置

```js
module.exports = api => {
  const isTest = api.env('test');
  // You can use isTest to determine what presets and plugins to use.
  return {
    // ...
  };
};
```

- 配置jest的转义

```js
// 当你安装 Jest 时，​babel-jest​ 是会被自动安装的，并且如果你的项目下存在一个 Babel 配置文件时，它将会自动对相关文件进行转义。 
// 如果要避免这个行为，你可以显式的重置 ​transform​ 配置项：
// // jest.config.js
module.exports = {
  transform: {},
};
```

- Babel 6 支持

```json
// Jest 24 放弃了对 Babel 6 的支持。我们强烈建议大家升级到 Babel 7，它得到了积极维护。
// 但是，如果你无法升级到 Babel 7，请继续使用 Jest 23 或升级到 Jest 24 并​babel-jest​锁定版本 23，如下例所示：
"dependencies": {
  "babel-core": "^6.26.3",
  "babel-jest": "^23.6.0",
  "babel-preset-env": "^1.7.0",
  "jest": "^24.0.0"
}
```

## 使用 TypeScript

```js
// Jest 通过 Babel 支持 TypeScript。首先，请确保你遵循了上面使用 Babel 的说明。
// 接下来，通过​yarn​安装​@babel/preset-typescript​：

// yarn add --dev @babel/preset-typescript

// 然后添加​@babel/preset-typescript​到你的​​​babel.config.js​.​​
// babel.config.js
module.exports = {
  presets: [
    ['@babel/preset-env', {targets: {node: 'current'}}],
      '@babel/preset-typescript',
  ],
};

// Babel 对 TypeScript 的支持是 transpilation，Jest 不会在运行时对你的测试进行类型检查。
// 如果你想实现这个功能，你可以使用 ​ts-jest​。
```


